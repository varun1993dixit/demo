<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8 />
		<title>A simple map</title>

		<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
		<script src='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.js'></script>
		<link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />
		<style>
			body {
				margin: 0;
				padding: 0;
			}
			#map {
				position: absolute;
				top: 0;
				bottom: 0;
				width: 100%;
			}
			img {
				height: 160px;
				width: 270px
			}
			.leaflet-popup-content {
				width: 290px
			}

			.css-icon {
				width: 0;
				height: 0;
				border-top: 10px solid transparent;
				border-bottom: 10px solid transparent;
				border-left: 10px solid #ff8888;
			}
			/*	.leaflet-marker-icon.css-icon.leaflet-zoom-animated.leaflet-interactive:hover{
			 css-icon: 150%
			 }*/
			.css-icon:hover {
				cursor: pointer;
				border-top: 40px solid transparent;
				border-bottom: 40px solid transparent;
				border-left: 40px solid #ff8888;
			}

		</style>
	</head>
	<body>
		<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/leaflet.markercluster.js'></script>
		<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.css' rel='stylesheet' />
		<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.Default.css' rel='stylesheet' />

		<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/leaflet.markercluster.js'></script>
		<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.css' rel='stylesheet' />
		<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v1.0.0/MarkerCluster.Default.css' rel='stylesheet' />

		<div id='map' class="dark"></div>

		<script src='https://code.jquery.com/jquery-1.11.0.min.js'></script>
		<script>
			L.mapbox.accessToken = 'pk.eyJ1IjoianRob21hc3NpZSIsImEiOiJHaUxIakJNIn0.-YMjtvwXuWt_ZwB9L5ZZYA';
			var map = L.mapbox.map('map','mapbox.light').setView([-37.82, 175.215], 8);

			var cssIcon = L.divIcon({
				// Specify a class name we can refer to in CSS.
				className : 'css-icon',
				// Set marker width and height
				iconSize : [10, 10]
			});
			var myLayer = L.mapbox.featureLayer().addTo(map);
			console.log(myLayer)
			var geoJson = {
				type : 'FeatureCollection',
				features : [{
					type : 'Feature',
					"geometry" : {
						"type" : "Point",
						"coordinates" : [-37.8210922667, 175.2209316333]
					},
					"properties" : {
						'title' : 'Washington, D.C.',
						'marker-color' : '#3c4e5a',
						'marker-symbol' : 'monument',
						'marker-size' : 'large',

						// Store the image url and caption in an array.
						'images' : [['https://i.imgur.com/O6QEpBs.jpg', 'The U.S. Capitol after the burning of Washington during the War of 1812'], ['https://i.imgur.com/xND1MND.jpg', 'Ford\'s Theatre in the 19th century, site of the 1865 assassination of President Lincoln'], ['https://i.imgur.com/EKJmqui.jpg', 'The National Cherry Blossom Festival is celebrated around the city each spring.']]
					}
				}, {
					type : 'Feature',
					"geometry" : {
						"type" : "Point",
						"coordinates" : [-37.8210819833, 175.2213903167]
					},
					"properties" : {
						'title' : 'New York City',
						'marker-color' : '#3c4e5a',
						'marker-symbol' : 'city',
						'marker-size' : 'large',
						'images' : [['https://i.imgur.com/exemdwr.png', 'Peter Minuit is credited with the purchase of the island of Manhattan in 1626.'], ['https://i.imgur.com/LHNDBpf.jpg', 'During the mid-19th Century, Broadway was extended the length of Manhattan.'], ['https://i.imgur.com/Pk3DYH1.jpg', 'Times Square has the highest annual attendance rate of any tourist attraction in the world.']]

					}

				}, {
					type : 'Feature',
					"geometry" : {
						"type" : "Point",
						"coordinates" : [-37.0, 175.0]
					},
					"properties" : {
						'title' : 'New York City',
						'marker-color' : '#3c4e5a',
						'marker-symbol' : 'city',
						'marker-size' : 'large',
						'images' : [['https://i.imgur.com/exemdwr.png', 'Peter Minuit is credited with the purchase of the island of Manhattan in 1626.'], ['https://i.imgur.com/LHNDBpf.jpg', 'During the mid-19th Century, Broadway was extended the length of Manhattan.'], ['https://i.imgur.com/Pk3DYH1.jpg', 'Times Square has the highest annual attendance rate of any tourist attraction in the world.']]

					},

				}, {
					type : 'Feature',
					"geometry" : {
						"type" : "Point",
						"coordinates" : [-37.1111, 175.22]
					},
					"properties" : {
						'title' : 'New York City',
						'marker-color' : '#3c4e5a',
						'marker-symbol' : 'city',
						'marker-size' : 'large',
						'images' : [['https://i.imgur.com/Pk3DYH1.jpg', 'Times Square has the highest annual attendance rate of any tourist attraction in the world.']]

					},

				}, {
					type : 'Feature',
					"geometry" : {
						"type" : "Point",
						"coordinates" : [-38.6, 175.3]
					},
					"properties" : {
						'title' : 'New York City',
						'marker-color' : '#3c4e5a',
						'marker-symbol' : 'city',
						'marker-size' : 'large',
						'images' : [['https://i.imgur.com/LHNDBpf.jpg', 'During the mid-19th Century, Broadway was extended the length of Manhattan.'], ['https://i.imgur.com/Pk3DYH1.jpg', 'Times Square has the highest annual attendance rate of any tourist attraction in the world.']]
					},

				}]
			};

			var markers = new L.MarkerClusterGroup();
			// var images=geoJson.features[1].properties.images[1]
			// console.log(images)
			console.log(geoJson.features[1].geometry.coordinates)
			for (var i = 0; i < 5; i++) {
				var a = geoJson.features[i].geometry.coordinates;
				var title = geoJson.features[i].properties.title;
				console.log(title)
				var images = geoJson.features[i].properties.images[0];
				var marker = L.marker(new L.LatLng(a[0], a[1]), {
					icon : cssIcon,
					//title : title,
					images : images
				})
				marker.bindPopup('<img src = ' + images + '>');
				markers.addLayer(marker);

			}
			map.addLayer(markers);

		</script>
	</body>
</html>